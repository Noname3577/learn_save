ได้เลยครับ! ต่อไปนี้คือตัวอย่างโค้ด **WinForms** สำหรับ VS Code ที่ซับซ้อนขึ้น โดยมีการใช้ **Class**, **Function (Method)**, **Array** และการจัดการอีเวนต์แบบหลายรูปแบบ พร้อมคอนโทรลหลากหลาย โดยจะมีการเก็บข้อมูลผู้ใช้ใน Array และแสดงผลลัพธ์ใน ListBox พร้อมการนำ OOP มาใช้อย่างเหมาะสม

---

```csharp name=Form1.cs
using System;
using System.Windows.Forms;
using System.Drawing;
using System.Collections.Generic;

namespace WinFormsComplexApp
{
    // 1. สร้างคลาส User เก็บข้อมูลผู้ใช้
    public class User
    {
        public string Name { get; set; }
        public int Age { get; set; }
        public string Gender { get; set; }
        public string FavoriteFruit { get; set; }

        // ฟังก์ชันสำหรับแสดงข้อมูลผู้ใช้แบบสวยงาม
        public override string ToString()
        {
            return $"{Name} | อายุ: {Age} | เพศ: {Gender} | ผลไม้โปรด: {FavoriteFruit}";
        }
    }

    public class Form1 : Form
    {
        // คอนโทรลต่าง ๆ
        private Label labelName, labelAge, labelFruit, labelGender;
        private TextBox textBoxName, textBoxAge;
        private ComboBox comboBoxFruit;
        private RadioButton radioMale, radioFemale;
        private Button buttonAdd, buttonClear;
        private ListBox listBoxUsers;
        private PictureBox pictureBox;
        private List<User> users = new List<User>(); // 2. ใช้ Array (List<User>) สำหรับเก็บข้อมูลผู้ใช้

        public Form1()
        {
            this.Text = "WinForms OOP & Array Example";
            this.Size = new Size(600, 450);

            // 3. สร้างและจัดตำแหน่งคอนโทรล

            labelName = new Label() { Text = "ชื่อ:", Location = new Point(30, 30), AutoSize = true };
            textBoxName = new TextBox() { Location = new Point(100, 30), Width = 200 };

            labelAge = new Label() { Text = "อายุ:", Location = new Point(30, 70), AutoSize = true };
            textBoxAge = new TextBox() { Location = new Point(100, 70), Width = 100 };

            labelGender = new Label() { Text = "เพศ:", Location = new Point(30, 110), AutoSize = true };
            radioMale = new RadioButton() { Text = "ชาย", Location = new Point(100, 110) };
            radioFemale = new RadioButton() { Text = "หญิง", Location = new Point(170, 110) };

            labelFruit = new Label() { Text = "ผลไม้โปรด:", Location = new Point(30, 150), AutoSize = true };
            comboBoxFruit = new ComboBox()
            {
                Location = new Point(100, 150),
                Width = 150,
                DropDownStyle = ComboBoxStyle.DropDownList
            };
            comboBoxFruit.Items.AddRange(new string[] { "Apple", "Banana", "Orange", "Grape", "Mango" });

            buttonAdd = new Button() { Text = "เพิ่มข้อมูล", Location = new Point(100, 200), Width = 100 };
            buttonAdd.Click += ButtonAdd_Click;

            buttonClear = new Button() { Text = "ล้างข้อมูล", Location = new Point(220, 200), Width = 100 };
            buttonClear.Click += ButtonClear_Click;

            listBoxUsers = new ListBox() { Location = new Point(330, 30), Size = new Size(230, 250) };

            pictureBox = new PictureBox()
            {
                Location = new Point(100, 250),
                Size = new Size(100, 100),
                BorderStyle = BorderStyle.FixedSingle,
                SizeMode = PictureBoxSizeMode.StretchImage
            };
            // ตัวอย่างใส่ภาพจาก URL (เฉพาะ Windows Forms >= .NET 5)
            try
            {
                pictureBox.Load("https://upload.wikimedia.org/wikipedia/commons/4/47/PNG_transparency_demonstration_1.png");
            }
            catch
            {
                // หากโหลดภาพไม่สำเร็จ
            }

            // 4. เพิ่มคอนโทรลทั้งหมดลงในฟอร์ม
            Controls.Add(labelName);
            Controls.Add(textBoxName);
            Controls.Add(labelAge);
            Controls.Add(textBoxAge);
            Controls.Add(labelGender);
            Controls.Add(radioMale);
            Controls.Add(radioFemale);
            Controls.Add(labelFruit);
            Controls.Add(comboBoxFruit);
            Controls.Add(buttonAdd);
            Controls.Add(buttonClear);
            Controls.Add(listBoxUsers);
            Controls.Add(pictureBox);
        }

        // 5. ฟังก์ชันเมื่อกดปุ่ม "เพิ่มข้อมูล"
        private void ButtonAdd_Click(object sender, EventArgs e)
        {
            // ตรวจสอบข้อมูลก่อนเพิ่ม
            string name = textBoxName.Text.Trim();
            int age;
            bool ageParsed = int.TryParse(textBoxAge.Text.Trim(), out age);
            string gender = radioMale.Checked ? "ชาย" : radioFemale.Checked ? "หญิง" : "";
            string fruit = comboBoxFruit.SelectedItem == null ? "" : comboBoxFruit.SelectedItem.ToString();

            if (string.IsNullOrEmpty(name) || !ageParsed || age < 1 || string.IsNullOrEmpty(gender) || string.IsNullOrEmpty(fruit))
            {
                MessageBox.Show("กรุณากรอกข้อมูลให้ครบถ้วนและถูกต้อง", "ข้อผิดพลาด", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }

            // 6. สร้าง object User และเพิ่มลงใน Array (List<User>)
            User user = new User()
            {
                Name = name,
                Age = age,
                Gender = gender,
                FavoriteFruit = fruit
            };
            users.Add(user);

            // 7. อัปเดต ListBox ด้วยข้อมูลใน Array
            UpdateUserList();
            ClearInput();
        }

        // 8. ฟังก์ชันเมื่อกดปุ่ม "ล้างข้อมูล"
        private void ButtonClear_Click(object sender, EventArgs e)
        {
            users.Clear();
            UpdateUserList();
        }

        // 9. ฟังก์ชันสำหรับอัปเดต ListBox
        private void UpdateUserList()
        {
            listBoxUsers.Items.Clear();
            foreach (var user in users)
            {
                listBoxUsers.Items.Add(user.ToString());
            }
        }

        // 10. ฟังก์ชันสำหรับล้างข้อมูลที่กรอก
        private void ClearInput()
        {
            textBoxName.Text = "";
            textBoxAge.Text = "";
            radioMale.Checked = false;
            radioFemale.Checked = false;
            comboBoxFruit.SelectedIndex = -1;
        }
    }
}
```

---

```csharp name=Program.cs
using System;
using System.Windows.Forms;

namespace WinFormsComplexApp
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }
}
```

---

## จุดเด่นของตัวอย่างนี้

- **มีการสร้างคลาส `User`** (OOP)
- **ใช้ Array (List<User>)** ในการเก็บข้อมูลผู้ใช้
- **มีฟังก์ชันต่าง ๆ** สำหรับการจัดการข้อมูล (เพิ่ม, ล้าง, อัปเดตหน้าจอ, ล้างอินพุต)
- **จัดการอีเวนต์** จากปุ่ม, และตรวจสอบความถูกต้องของข้อมูล
- **แสดงผลลัพธ์ใน ListBox**
- **มี PictureBox สำหรับแสดงรูปภาพ**
- **รองรับการใช้งานใน VS Code** (สร้างโฟลเดอร์, วางไฟล์, รันด้วย `dotnet run`)

---

หากต้องการฟีเจอร์เพิ่มเติม เช่น การค้นหา, การแก้ไข/ลบข้อมูล, หรือการบันทึกลงไฟล์ แจ้งได้เลยครับ!
